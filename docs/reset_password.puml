@startuml
title Reset password

participant Client
participant Server
database Database

note over Client
  <math>W_c = H("new-pass")</math>
end note

note over Client
  <math>"Pick " k_</math>
end note

note over Client
  <math>\tau = "MAC"_{S_{cs}}(I_c || E_{W_c}^k(P_c) || k)</math>
end note

Client ->> Server: <math>(I_c || E_{W_c}^{k}(P_c) || k) || \tau</math>
Server ->> Database: Request
Database ->> Server: <math>U_c</math>

note over Server
    <math>S_{cs} = DH(U_c, P_s)</math>
end note

note over Server
    <math>"Check " \tau</math>
end note




Server ->> Database: <math>E_{W_c}^{k}(P_c) || k</math>
@enduml